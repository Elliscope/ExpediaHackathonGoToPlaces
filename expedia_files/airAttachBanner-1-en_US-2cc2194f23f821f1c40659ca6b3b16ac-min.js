(function(){var f=Handlebars.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(f,c,e,b,a){var d,g;return'\x3ca href\x3d"'+f.escapeExpression((g=null!=(g=e.hotelSearchUrl||(null!=c?c.hotelSearchUrl:c))?g:e.helperMissing,"function"===typeof g?g.call(null!=c?c:{},{name:"hotelSearchUrl",hash:{},data:a}):g))+'" class\x3d"cf" data-onclick\x3d"xp.nav.trackAnalytics(this,\'a\',\'HP.ATTACH.Hotel\')"\x3e\n    \x3cspan class\x3d"air-attach-message"\x3e\n        \x3cspan class\x3d"icon icon-flights" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n        \x3cspan class\x3d"icon"\x3e+\x3c/span\x3e\n        \x3cspan class\x3d"icon icon-hotels" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n        '+(null!=(d=f.lambda(null!=(d=null!=c?c.loc:c)?d.hotelDiscountMessage:d,c))?d:"")+'\n    \x3c/span\x3e\n    \x3cspan class\x3d"offer-countdown" data-days\x3d"X days"\x3e\n        \x3cspan class\x3d"icon icon-time" aria-hidden\x3d"true"\x3e\x3c/span\x3e\n        '+(null!=(d=f.lambda(null!=(d=null!=c?c.loc:c)?d.offerExpireMessage:d,c))?d:"")+' \x3cspan class\x3d"offer-countdown-timer"\x3ehh:mm:ss\x3c/span\x3e\n    \x3c/span\x3e\n\x3c/a\x3e\n'},useData:!0});Handlebars.templates=Handlebars.templates||{};Handlebars.templates.airAttach=f;Handlebars.partials=Handlebars.partials||{};Handlebars.partials.airAttach=f})();define("airAttach-loc",function(){return{hotelDiscountMessage:'Your flight purchase qualifies you for up to {{g_msg_discountValue}}% off select \x3cu\x3ehotels\x3c/u\x3e for your \x3cb class\x3d"airattach-trip-cityname" \x3e{{cityname}}\x3c/b\x3e trip',mipqDiscountMessage:'Your recent booking qualifies you for up to 40% off select hotels for your \x3cb class\x3d"airattach-trip-cityname" \x3e{{cityname}}\x3c/b\x3e trip',offerExpireMessage:"Offer expires in"}});var dependencies=["handlebars","hotelSearchUrl","airAttach-loc","uitk","uitk_localized_dateApi"];define("airAttachBanner",dependencies,function(f,k,c,e){var b=b||{};b.init=function(){require(["storefrontPageModel"],function(a){a=JSON.parse(a.watsonDataJson);a=a.multiItemPriceQualification;if("object"===typeof a){var d="January February March April May June July August September October November December".split(" "),g=new Date(1E3*a.startDate.seconds),c=new Date(1E3*a.endDate.seconds);b.timer=((new Date(1E3*a.expirationDate.seconds)).getTime()-(new Date).getTime())/1E3;b.startDate=e.utils.createLocalizedDate(d[g.getMonth()]+" "+g.getDate()+" "+g.getFullYear(),e.locale).shortDate();b.endDate=e.utils.createLocalizedDate(d[c.getMonth()]+" "+c.getDate()+" "+c.getFullYear(),e.locale).shortDate();b.enableOfferWindowTillTravel=!1;b.destinationName=a.destinationName;b.destinationID=a.destinationID;b.showMipqBanner()}else $.ajax({dataType:"json",url:"/api/airattach/qualification",success:b.callback,complete:function(b,a,d){var c={status:a};"success"==a&&"object"==typeof b&&"string"==typeof b.responseText&&0<b.responseText.length&&-1<b.responseText.indexOf("tripID")&&(c.hasTripInfo=!0);window.dctk&&dctk.enabled&&dctk.logging&&dctk.logging.logError?dctk.logging.logMessage("sf-web:air-attach",c):require("dctk/clientLogging",function(b){b.logMessage("sf-web:air-attach",c)})},cache:!1,timeout:5E3})})};b.callback=function(a){if(a&&a.qualificationWindows&&0<a.qualificationWindows.length){a=a.qualificationWindows[0];var d=a.tripInfo.finalDestinationAirportCode;b.setAirattachData(a);b.setSearchUrlAndCityName(d);if(window.dctk&&window.dctk.onReady)dctk.onReady(function(){dctk.trackAction("MIP.Hot.Shown.Storefront")});else require("dctk/dctk",function(b){b.onReady(function(){b.trackAction("MIP.Hot.Shown.Storefront")})});b.mipqBannerTracking()}};b.setAirattachData=function(a){b.timer=a.timeLeftForExpirationInMilliSecs/1E3;b.startDate=e.utils.createLocalizedDate(a.startDate,e.locale).shortDate();b.endDate=e.utils.createLocalizedDate(a.endDate,e.locale).shortDate();b.origin=a.tripInfo.originAirportCode;b.tripType=a.tripInfo.tripType;b.enableOfferWindowTillTravel=a.enableOfferWindowTillTravel};b.renderCountdown=function(){var a,d,c,f=$(".offer-countdown-timer"),e=$(".offer-countdown");var h=b.enableOfferWindowTillTravel?Math.ceil(b.timer/86400):Math.floor(b.timer/86400);if(3<=h){var l=$(e).attr("data-days");h=l&&-1<l.indexOf("X")?l.replace("X",h):h+" days";$(f).html(h);$(e).addClass("timer-ready")}else{var k=$(".offer-countdown-timer").html();setInterval(function(){var g=b.timer--;a=parseInt(g/3600);g%=3600;d=parseInt(g/60);c=parseInt(g%60);10>a&&(a="0"+a);10>d&&(d="0"+d);10>c&&(c="0"+c);g=k.replace("hh",a).replace("mm",d).replace("ss",c);$(f).html(g);$(e).addClass("timer-ready")},1E3)}};b.showMipqBanner=function(){b.hotelSearchUrl=k({regionId:b.destinationID,rooms:[{adults:1}],startDate:b.startDate,endDate:b.endDate});var a={hotelSearchUrl:b.hotelSearchUrl,loc:{hotelDiscountMessage:c.mipqDiscountMessage.replace("{{cityname}}",b.destinationName),offerExpireMessage:c.offerExpireMessage}},d=(0,f.partials.airAttach)(a);a=$(".air-attach-container");a.html(d);b.renderCountdown();d=a.height();a.css("height",0).animate({height:d,opacity:1},1500,function(){$(this).css("height","auto")});b.mipqBannerTracking()};b.setSearchUrlAndCityName=function(a){b.getDataFromAirportTla(a,function(a){b.regionId=a.sr[0].hierarchyInfo.airport.multicity;b.cityname=a.sr[0].regionNames.shortName.split(",")[0].replace(/(<([^>]+)>)/ig,"");b.hotelSearchUrl=k({regionId:b.regionId,rooms:[{adults:1}],startDate:"ROUND_TRIP"==b.tripType?b.startDate:"",endDate:"ROUND_TRIP"==b.tripType?b.endDate:""});a={1:"54",3:"41",4:"51",6:"26",8:"26",9:"20",11:"38",12:"56",14:"56",15:"54",16:"56",17:"52",18:"54",20:"39",25:"55",27:"54",28:"68",29:"54",61:"55",62:"43",63:"30",64:"24",65:"7",66:"24",67:"25",68:"46",69:"56",70:"56",72:"55",73:"7"};a=c.hotelDiscountMessage.replace("{{g_msg_discountValue}}",void 0===a[siteid]?"56":a[siteid]);c.hotelDiscountMessage=a;a=c.hotelDiscountMessage.replace("{{cityname}}",b.cityname);c.hotelDiscountMessage=a;var d=(0,f.partials.airAttach)({cityname:b.cityname,g_msg_discountValue:"41",hotelSearchUrl:b.hotelSearchUrl,loc:c}),e=$(".air-attach-container");"1"===siteid||"14"===siteid?require("sfAbTest",function(a){a.get(14553,!0,function(a){1===a.value&&(e=$("#hotmip-container"));e.html(d);b.renderCountdown();a=e.height();e.css("height",0).animate({height:a,opacity:1},1500,function(){$(this).css("height","auto")})})}):(e.html(d),b.renderCountdown(),a=e.height(),e.css("height",0).animate({height:a,opacity:1},1500,function(){$(this).css("height","auto")}))})};b.getDataFromAirportTla=function(a,b){$.ajax({dataType:"jsonp",url:"https://suggest.expedia.com/api/v4/typeahead/"+a+"?format\x3djsonp\x26client\x3dHomepage\x26regiontype\x3d1\x26maxresults\x3d1\x26lob\x3dFLIGHTS\x26locale\x3d"+locale,success:b,timeout:5E3})};b.mipqBannerTracking=function(){require("dctk/dctk",function(a){a.onReady(function(){a.trackEvent({trackEvents:"event132,event152"})})})};return b});require(["airAttachBanner"],function(f){f.init()});function hotMipClickThroughTracking(){$(document).on(uitk.clickEvent,".air-attach-container",function(){if(window.dctk&&window.dctk.onReady)dctk.onReady(function(){dctk.trackAction("MIP.Hot.Click.Storefront")});else require("dctk/dctk",function(f){f.onReady(function(){f.trackAction("MIP.Hot.Click.Storefront")})})})}window.define&&window.require&&window.define.amd?require(["jquery"],function(f){f(document).ready(function(){hotMipClickThroughTracking()})}):"undefined"!==typeof $&&$(document).ready(function(){hotMipClickThroughTracking()});
//# sourceMappingURL=airAttachBanner-1-en_US.js.map